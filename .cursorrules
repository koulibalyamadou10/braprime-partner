# BraPrime - RÃ¨gles de DÃ©veloppement Cursor

## ğŸ¯ Vue d'ensemble du Projet

BraPrime est une plateforme de livraison complÃ¨te dÃ©veloppÃ©e en React + TypeScript avec Supabase comme backend. Le projet supporte 4 rÃ´les : clients, partenaires (commerces), chauffeurs et administrateurs.

## ğŸ—ï¸ Architecture Technique

### Stack Technologique
- **Frontend** : React 18 + TypeScript + Vite
- **UI** : Shadcn/ui + Radix UI + Tailwind CSS
- **Backend** : Supabase (PostgreSQL + Auth + Storage)
- **State Management** : React Query (TanStack Query)
- **Routing** : React Router DOM
- **Forms** : React Hook Form + Zod
- **Maps** : Leaflet + React Leaflet
- **Charts** : Recharts

### Structure des Dossiers
```
src/
â”œâ”€â”€ components/          # Composants rÃ©utilisables
â”‚   â”œâ”€â”€ ui/             # Composants Shadcn/ui
â”‚   â”œâ”€â”€ auth/           # Composants d'authentification
â”‚   â””â”€â”€ dashboard/      # Composants du dashboard
â”œâ”€â”€ pages/              # Pages de l'application
â”‚   â””â”€â”€ dashboard/      # Pages du dashboard par rÃ´le
â”œâ”€â”€ hooks/              # Hooks personnalisÃ©s
â”œâ”€â”€ lib/                # Utilitaires et configuration
â”‚   â”œâ”€â”€ services/       # Services API Supabase
â”‚   â””â”€â”€ types/          # Types TypeScript
â”œâ”€â”€ contexts/           # Contextes React
â””â”€â”€ config/             # Configuration de l'app
```

## ğŸ“ Conventions de Code

### TypeScript
- Toujours utiliser des types stricts
- PrÃ©fÃ©rer les interfaces aux types pour les objets
- Utiliser les types gÃ©nÃ©riques pour les hooks et services
- Documenter les types complexes avec des commentaires JSDoc

### React
- Utiliser des composants fonctionnels avec hooks
- PrÃ©fÃ©rer les hooks personnalisÃ©s pour la logique rÃ©utilisable
- Utiliser React.memo() pour les composants lourds
- ImplÃ©menter le lazy loading pour les pages

### Styling
- Utiliser Tailwind CSS pour tous les styles
- PrÃ©fÃ©rer les classes utilitaires aux styles personnalisÃ©s
- Utiliser les variants de Shadcn/ui pour les variations
- Respecter le design system Ã©tabli

### Naming Conventions
- **Composants** : PascalCase (ex: `UserDashboard.tsx`)
- **Hooks** : camelCase avec prÃ©fixe "use" (ex: `useUserProfile.ts`)
- **Services** : camelCase (ex: `userProfile.ts`)
- **Types** : PascalCase (ex: `UserProfile`)
- **Constantes** : UPPER_SNAKE_CASE (ex: `API_ENDPOINTS`)

## ğŸ—„ï¸ Base de DonnÃ©es (Supabase)

### Conventions SQL
- Utiliser des noms de tables au pluriel (ex: `user_profiles`)
- PrÃ©fÃ©rer les UUID pour les clÃ©s primaires
- Utiliser des timestamps avec timezone
- ImplÃ©menter RLS sur toutes les tables
- CrÃ©er des index pour les colonnes frÃ©quemment requÃªtÃ©es

### Tables Principales
- `user_profiles` : Profils utilisateurs
- `businesses` : Commerces/restaurants
- `orders` : Commandes
- `drivers` : Chauffeurs
- `reservations` : RÃ©servations
- `cart` : Panier utilisateur

### Fonctions PostgreSQL
- CrÃ©er des fonctions pour les calculs complexes
- Utiliser des triggers pour l'historique automatique
- ImplÃ©menter des vues pour les requÃªtes frÃ©quentes

## ğŸ” Authentification et SÃ©curitÃ©

### RÃ´les Utilisateurs
1. **customer** : Clients finaux
2. **partner** : PropriÃ©taires de commerces
3. **driver** : Chauffeurs de livraison
4. **admin** : Administrateurs systÃ¨me

### Politiques RLS
- Chaque table doit avoir des politiques RLS appropriÃ©es
- Les utilisateurs ne peuvent voir que leurs propres donnÃ©es
- Les partenaires peuvent voir les donnÃ©es de leurs commerces
- Les admins ont accÃ¨s Ã  toutes les donnÃ©es

### Validation
- Utiliser Zod pour la validation cÃ´tÃ© client
- ImplÃ©menter la validation cÃ´tÃ© serveur avec Supabase
- Valider tous les inputs utilisateur

## ğŸš€ FonctionnalitÃ©s Principales

### SystÃ¨me de Commandes
- Panier persistant avec Supabase
- Calcul automatique des frais de livraison
- Suivi GPS en temps rÃ©el
- Historique dÃ©taillÃ© des statuts

### Gestion des Chauffeurs
- Authentification dÃ©diÃ©e
- SystÃ¨me d'offres de livraison
- Gestion des documents
- Sessions de travail avec calculs

### Dashboard Multi-RÃ´les
- Interface adaptÃ©e Ã  chaque rÃ´le
- Statistiques en temps rÃ©el
- Gestion des notifications
- Profils utilisateurs complets

## ğŸ¨ UI/UX Guidelines

### Design System
- Utiliser les composants Shadcn/ui comme base
- Respecter la palette de couleurs dÃ©finie
- Maintenir la cohÃ©rence visuelle
- Optimiser pour mobile-first

### Composants
- CrÃ©er des composants rÃ©utilisables
- Utiliser la composition plutÃ´t que l'hÃ©ritage
- ImplÃ©menter des props avec des types stricts
- Ajouter des tests pour les composants critiques

### Responsive Design
- Mobile-first approach
- Utiliser les breakpoints Tailwind
- Tester sur diffÃ©rents appareils
- Optimiser les interactions tactiles

## ğŸ“Š Performance

### Optimisations Frontend
- Lazy loading des pages et composants
- Memoization des calculs coÃ»teux
- Optimisation des re-renders
- Code splitting automatique avec Vite

### Optimisations Backend
- Index sur les colonnes de recherche
- Pagination pour les listes longues
- Mise en cache des requÃªtes frÃ©quentes
- Optimisation des requÃªtes SQL

## ğŸ§ª Tests et QualitÃ©

### Tests
- Tests unitaires pour les hooks et services
- Tests d'intÃ©gration pour les workflows critiques
- Tests E2E pour les parcours utilisateur
- Tests de performance pour les requÃªtes

### QualitÃ© de Code
- Utiliser ESLint avec les rÃ¨gles TypeScript
- Formater le code avec Prettier
- VÃ©rifier les types TypeScript
- Documenter les fonctions complexes

## ğŸ”§ Configuration et DÃ©ploiement

### Variables d'Environnement
- Utiliser des variables d'environnement pour les clÃ©s API
- Ne jamais commiter les secrets
- Documenter les variables requises

### Supabase
- Utiliser les migrations SQL pour les changements de schÃ©ma
- Tester les migrations sur un environnement de staging
- Sauvegarder rÃ©guliÃ¨rement la base de donnÃ©es

## ğŸ“š Documentation

### Code Documentation
- Commenter les fonctions complexes
- Documenter les types personnalisÃ©s
- Expliquer les dÃ©cisions d'architecture
- Maintenir un README Ã  jour

### API Documentation
- Documenter les endpoints Supabase
- Expliquer les politiques RLS
- Documenter les fonctions PostgreSQL
- Maintenir des exemples d'utilisation

## ğŸš¨ Bonnes Pratiques

### GÃ©nÃ©ral
- Toujours vÃ©rifier les permissions avant les opÃ©rations
- GÃ©rer les erreurs de maniÃ¨re appropriÃ©e
- Utiliser des messages d'erreur informatifs
- ImplÃ©menter le loading states

### React
- Ã‰viter les re-renders inutiles
- Utiliser les hooks dans le bon ordre
- Nettoyer les effets avec useEffect
- PrÃ©fÃ©rer les callbacks stables

### TypeScript
- Utiliser des types stricts
- Ã‰viter les `any`
- Utiliser les utilitaires TypeScript
- Valider les types Ã  la compilation

### Supabase
- Utiliser les types gÃ©nÃ©rÃ©s automatiquement
- ImplÃ©menter la gestion d'erreurs
- Utiliser les transactions pour les opÃ©rations multiples
- Optimiser les requÃªtes avec des vues

## ğŸ¯ RÃ¨gles SpÃ©cifiques au Projet

### Gestion des Ã‰tats
- Utiliser React Query pour le cache serveur
- Utiliser les contextes pour l'Ã©tat global
- PrÃ©fÃ©rer les hooks locaux pour l'Ã©tat simple

### Navigation
- Utiliser React Router pour la navigation
- ImplÃ©menter la protection des routes par rÃ´le
- GÃ©rer les redirections aprÃ¨s authentification

### Formulaires
- Utiliser React Hook Form pour tous les formulaires
- Valider avec Zod
- GÃ©rer les Ã©tats de soumission
- Afficher les erreurs de validation

### Notifications
- Utiliser Sonner pour les toasts
- ImplÃ©menter les notifications en temps rÃ©el
- GÃ©rer les notifications push

## ğŸ”„ Workflow de DÃ©veloppement

### Branches
- `main` : Code de production
- `develop` : Branche de dÃ©veloppement
- `feature/*` : Nouvelles fonctionnalitÃ©s
- `fix/*` : Corrections de bugs

### Commits
- Utiliser des messages de commit descriptifs
- PrÃ©fixer avec le type de changement
- RÃ©fÃ©rencer les issues si applicable

### Code Review
- VÃ©rifier la sÃ©curitÃ© des nouvelles fonctionnalitÃ©s
- Tester les migrations de base de donnÃ©es
- Valider l'accessibilitÃ©
- VÃ©rifier la performance

---

## ğŸ“ Support

Pour toute question sur ces rÃ¨gles ou le projet :
1. Consulter la documentation du projet
2. VÃ©rifier les exemples de code existants
3. Suivre les conventions Ã©tablies
4. Demander clarification si nÃ©cessaire

**Objectif** : Maintenir un code de qualitÃ©, sÃ©curisÃ© et maintenable pour une plateforme de livraison de niveau professionnel. 